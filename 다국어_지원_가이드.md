# 🌍 Youniqle 다국어 지원 시스템 가이드

## 📋 목차
1. [시스템 개요](#시스템-개요)
2. [구현 완료 내역](#구현-완료-내역)
3. [시스템 아키텍처](#시스템-아키텍처)
4. [적용된 페이지](#적용된-페이지)
5. [향후 적용 예정](#향후-적용-예정)
6. [사용 방법](#사용-방법)
7. [새 페이지 다국어 적용 가이드](#새-페이지-다국어-적용-가이드)

---

## 시스템 개요

### 지원 언어
- 🇰🇷 **한국어 (ko)** - 기본 언어
- 🇬🇧 **영어 (en)** - 싱가포르 및 글로벌 시장
- 🇨🇳 **중국어 간체 (zh)** - 싱가포르 중국어 사용자 대상

### 기술 스택
- **React Context API** - 전역 언어 상태 관리
- **localStorage** - 사용자 언어 선택 저장
- **JSON 파일** - 번역 리소스 관리
- **동적 파라미터 지원** - `{count}`, `{name}` 등 변수 치환

### 왜 next-intl을 사용하지 않았나?
- next-intl은 URL 기반 라우팅(`/en/products`, `/ko/products`)을 강제함
- 기존 프로젝트 구조 변경 최소화를 위해 Context API 방식 선택
- localStorage 기반으로 사용자 선호 언어 유지

---

## 구현 완료 내역

### 1. 핵심 시스템 파일

#### 📁 `src/contexts/LanguageContext.tsx`
```typescript
'use client';

import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { locales, type Locale } from '@/i18n/config';

interface LanguageContextType {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (key: string, params?: Record<string, any>) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [locale, setLocaleState] = useState<Locale>('ko');
  const [messages, setMessages] = useState<Record<string, any>>({});

  useEffect(() => {
    // localStorage 또는 브라우저 언어 감지
    const storedLocale = localStorage.getItem('locale') as Locale;
    const browserLocale = navigator.language.split('-')[0] as Locale;
    const initialLocale = locales.includes(storedLocale) 
      ? storedLocale 
      : (locales.includes(browserLocale) ? browserLocale : 'ko');
    
    setLocaleState(initialLocale);
    loadMessages(initialLocale);
  }, []);

  const loadMessages = async (currentLocale: Locale) => {
    try {
      const response = await fetch(`/locales/${currentLocale}.json`);
      const data = await response.json();
      setMessages(data);
    } catch (error) {
      console.error(`Failed to load messages for ${currentLocale}:`, error);
      setMessages({});
    }
  };

  const setLocale = (newLocale: Locale) => {
    if (locales.includes(newLocale)) {
      setLocaleState(newLocale);
      localStorage.setItem('locale', newLocale);
      loadMessages(newLocale);
    }
  };

  // 중첩된 키 지원 (예: 'cart.title')
  const t = (key: string, params?: Record<string, any>) => {
    const keys = key.split('.');
    let value: any = messages;

    for (const k of keys) {
      if (value && typeof value === 'object') {
        value = value[k];
      } else {
        return key; // 키를 찾지 못하면 키 자체 반환
      }
    }

    if (typeof value !== 'string') {
      return key;
    }

    // 파라미터 치환 (예: {count}, {name})
    if (params) {
      return value.replace(/\{(\w+)\}/g, (match, param) => {
        return params[param]?.toString() || match;
      });
    }

    return value;
  };

  return (
    <LanguageContext.Provider value={{ locale, setLocale, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within LanguageProvider');
  }
  return context;
}
```

#### 📁 `src/i18n/config.ts`
```typescript
export const locales = ['ko', 'en', 'zh'] as const;
export type Locale = (typeof locales)[number];

export const localeNames: Record<Locale, string> = {
  ko: '한국어',
  en: 'English',
  zh: '简体中文',
};
```

#### 📁 `src/components/ui/LanguageSwitcher.tsx`
```typescript
'use client';

import { useLanguage } from '@/contexts/LanguageContext';
import { locales, localeNames } from '@/i18n/config';
import { Globe } from 'lucide-react';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Button } from '@/components/ui/button';

export default function LanguageSwitcher() {
  const { locale, setLocale } = useLanguage();

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="icon" className="relative">
          <Globe className="h-5 w-5" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        {locales.map((loc) => (
          <DropdownMenuItem
            key={loc}
            onClick={() => setLocale(loc)}
            className={locale === loc ? 'bg-accent' : ''}
          >
            {localeNames[loc]}
          </DropdownMenuItem>
        ))}
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

### 2. 루트 레이아웃 설정

#### 📁 `src/app/layout.tsx`
```typescript
import { LanguageProvider } from '@/contexts/LanguageContext';
import { SessionProvider } from '@/components/providers/SessionProvider';

export default function RootLayout({ children }: { children: React.ReactNode; }) {
  return (
    <html lang="ko">
      <body className={`${inter.className} min-h-screen flex flex-col`}>
        <LanguageProvider>
          <SessionProvider>
            <Header />
            <main className="flex-1">
              {children}
            </main>
            <Footer />
          </SessionProvider>
        </LanguageProvider>
      </body>
    </html>
  );
}
```

### 3. 번역 파일 구조

#### 📁 `src/locales/ko.json`
```json
{
  "common": {
    "brand": "Youniqle",
    "loading": "로딩 중...",
    "error": "오류가 발생했습니다"
  },
  "nav": {
    "products": "상품",
    "content": "콘텐츠",
    "about": "소개",
    "cart": "장바구니",
    "myPage": "마이페이지",
    "login": "로그인",
    "logout": "로그아웃",
    "signup": "회원가입"
  },
  "cart": {
    "title": "장바구니",
    "empty": "장바구니가 비어있습니다",
    "totalItems": "총 {count}개의 상품",
    "selectAll": "전체 선택",
    "checkout": "주문하기",
    "checkoutWithCount": "주문하기 ({count}개)"
  }
}
```

#### 📁 `src/locales/en.json`
```json
{
  "common": {
    "brand": "Youniqle",
    "loading": "Loading...",
    "error": "An error occurred"
  },
  "nav": {
    "products": "Products",
    "content": "Content",
    "about": "About",
    "cart": "Cart",
    "myPage": "My Page",
    "login": "Login",
    "logout": "Logout",
    "signup": "Sign Up"
  },
  "cart": {
    "title": "Shopping Cart",
    "empty": "Your cart is empty",
    "totalItems": "Total {count} items",
    "selectAll": "Select All",
    "checkout": "Checkout",
    "checkoutWithCount": "Checkout ({count} items)"
  }
}
```

#### 📁 `src/locales/zh.json`
```json
{
  "common": {
    "brand": "Youniqle",
    "loading": "加载中...",
    "error": "发生错误"
  },
  "nav": {
    "products": "商品",
    "content": "内容",
    "about": "关于",
    "cart": "购物车",
    "myPage": "我的页面",
    "login": "登录",
    "logout": "登出",
    "signup": "注册"
  },
  "cart": {
    "title": "购物车",
    "empty": "购物车为空",
    "totalItems": "共 {count} 件商品",
    "selectAll": "全选",
    "checkout": "结账",
    "checkoutWithCount": "结账 ({count} 件)"
  }
}
```

---

## 시스템 아키텍처

### 데이터 흐름
```
1. 사용자가 LanguageSwitcher에서 언어 선택
   ↓
2. LanguageContext의 setLocale() 호출
   ↓
3. localStorage에 선택한 언어 저장
   ↓
4. 해당 언어의 JSON 파일 로드 (/locales/{locale}.json)
   ↓
5. Context의 messages 상태 업데이트
   ↓
6. 모든 컴포넌트의 t() 함수가 새로운 번역 반환
```

### 컴포넌트에서 사용하는 방법
```typescript
import { useLanguage } from '@/contexts/LanguageContext';

function MyComponent() {
  const { t, locale } = useLanguage();
  
  return (
    <div>
      <h1>{t('cart.title')}</h1>
      <p>{t('cart.totalItems', { count: 5 })}</p>
      {/* 결과: "총 5개의 상품" (ko) / "Total 5 items" (en) */}
    </div>
  );
}
```

---

## 적용된 페이지

### ✅ 완료된 페이지

#### 1. **헤더 컴포넌트** (`src/components/layout/Header.tsx`)
- 네비게이션 메뉴 (상품, 콘텐츠, 소개)
- 검색 플레이스홀더
- 로그인/로그아웃/회원가입 버튼
- 장바구니, 마이페이지 링크
- 모바일 메뉴 포함

```typescript
// 적용 예시
<Link href="/products">{t('nav.products')}</Link>
<Input placeholder={t('products.search')} />
<Button>{t('nav.login')}</Button>
```

#### 2. **장바구니 페이지** (`src/app/cart/page.tsx`)
- 페이지 제목
- 전체 선택 체크박스
- 상품 금액, 배송비, 총 결제금액
- 주문하기 버튼
- 빈 장바구니 메시지
- 쇼핑 계속하기 버튼

```typescript
// 적용 예시
<h1>{t('cart.title')}</h1>
<span>{t('cart.totalItems', { count: cart.totalItems })}</span>
<Button>{t('cart.checkoutWithCount', { count: selectedItems.size })}</Button>
```

#### 3. **체크아웃 페이지** (`src/app/checkout/page.tsx`)
- 필수 정보 입력 안내 메시지
- 약관 동의 메시지
- 주문 요약 섹션

```typescript
// 적용 예시
alert(t('checkout.fillAllFields'));
alert(t('checkout.agreeRequired'));
<CardTitle>{t('checkout.orderSummary')}</CardTitle>
```

#### 4. **결제 결과 페이지**

##### `/order-success` - 결제 성공
```typescript
<CardTitle>{t('payment.success')}</CardTitle>
<span>{t('payment.orderNumber')}</span>
<span>{t('payment.amount')}</span>
<p>{t('payment.successMessage')}</p>
<Link href="/orders">{t('payment.viewOrders')}</Link>
```

##### `/order-failed` - 결제 실패
```typescript
<CardTitle>{t('payment.failed')}</CardTitle>
<span>{t('payment.errorMessage')}</span>
<p>{t('payment.failedMessage')}</p>
<Link href="/checkout">{t('payment.retryPayment')}</Link>
```

##### `/order-cancelled` - 결제 취소
```typescript
<CardTitle>{t('payment.cancelled')}</CardTitle>
<span>{t('payment.cancelReason')}</span>
<p>{t('payment.cancelledMessage')}</p>
```

---

## 향후 적용 예정

### 🔄 다음 단계로 적용할 페이지들

#### 1. **상품 관련 페이지**
- [ ] 상품 목록 페이지 (`/products`)
  - 카테고리 필터
  - 가격 정렬
  - 검색 결과 표시
  
- [ ] 상품 상세 페이지 (`/products/[id]`)
  - 상품 설명
  - 리뷰 섹션
  - Q&A 섹션
  - 바로 구매/장바구니 담기 버튼

#### 2. **인증 페이지**
- [ ] 로그인 페이지 (`/auth/signin`)
  - 이메일/비밀번호 입력 필드
  - 로그인 버튼
  - 회원가입 링크
  
- [ ] 회원가입 페이지 (`/auth/signup`)
  - 입력 필드 레이블
  - 약관 동의 체크박스
  - 가입 완료 메시지

- [ ] 이메일 인증 페이지 (`/auth/verify-email`)
  - 인증 안내 메시지
  - 재전송 버튼

#### 3. **콘텐츠 페이지**
- [ ] 콘텐츠 메인 (`/content`)
  - 블로그, 비디오, 쇼츠 탭
  
- [ ] 블로그 페이지 (`/content/blog`)
  - 게시글 목록
  - 카테고리 필터
  
- [ ] 비디오 페이지 (`/content/video`)
  - 비디오 목록
  - 재생 시간 표시

#### 4. **마이페이지**
- [ ] 사용자 정보 페이지 (`/me`)
  - 프로필 수정
  - 주문 내역
  - 위시리스트
  - 멤버십 정보

#### 5. **기타 페이지**
- [ ] 소개 페이지 (`/about`)
- [ ] 이용약관 (`/terms`)
- [ ] 개인정보처리방침 (`/privacy`)
- [ ] 주문 내역 (`/orders`)
- [ ] 위시리스트 (`/wishlist`)

---

## 사용 방법

### 1. 언어 전환
- 헤더 우측의 🌐 지구본 아이콘 클릭
- 드롭다운에서 원하는 언어 선택
- 선택된 언어는 localStorage에 저장되어 유지

### 2. 초기 언어 설정
- localStorage에 저장된 언어 우선
- 없으면 브라우저 언어 감지
- 지원하지 않는 언어면 기본값(한국어) 사용

### 3. 번역 추가하기
1. `src/locales/ko.json`, `en.json`, `zh.json`에 키-값 추가
2. 컴포넌트에서 `t('키')` 형태로 사용
3. 파라미터가 필요하면 `t('키', { param: value })` 형태

---

## 새 페이지 다국어 적용 가이드

### Step 1: useLanguage Hook 추가
```typescript
'use client'; // Client Component로 변경 필요

import { useLanguage } from '@/contexts/LanguageContext';

export default function MyPage() {
  const { t } = useLanguage();
  
  // 나머지 코드...
}
```

### Step 2: 하드코딩된 텍스트를 t() 함수로 변경
```typescript
// Before
<h1>상품 목록</h1>
<button>장바구니에 담기</button>

// After
<h1>{t('products.title')}</h1>
<button>{t('products.addToCart')}</button>
```

### Step 3: 동적 값이 필요한 경우
```typescript
// Before
<p>총 {count}개의 상품</p>

// After
<p>{t('products.totalCount', { count })}</p>
```

### Step 4: 번역 키 추가
```json
// src/locales/ko.json
{
  "products": {
    "title": "상품 목록",
    "addToCart": "장바구니에 담기",
    "totalCount": "총 {count}개의 상품"
  }
}

// src/locales/en.json
{
  "products": {
    "title": "Products",
    "addToCart": "Add to Cart",
    "totalCount": "Total {count} products"
  }
}

// src/locales/zh.json
{
  "products": {
    "title": "商品列表",
    "addToCart": "加入购物车",
    "totalCount": "共 {count} 件商品"
  }
}
```

### Step 5: 빌드 테스트
```bash
npm run build
```

---

## 번역 키 네이밍 규칙

### 1. 카테고리별 그룹화
```json
{
  "common": {},      // 공통 (브랜드, 에러, 로딩 등)
  "nav": {},         // 네비게이션
  "cart": {},        // 장바구니
  "checkout": {},    // 체크아웃
  "payment": {},     // 결제
  "products": {},    // 상품
  "auth": {},        // 인증
  "content": {}      // 콘텐츠
}
```

### 2. 의미 있는 키 이름
```json
{
  "cart": {
    "title": "장바구니",              // 페이지 제목
    "empty": "장바구니가 비어있습니다",  // 상태 메시지
    "emptyDesc": "...",              // 상세 설명
    "checkout": "주문하기",           // 액션 버튼
    "removeConfirm": "..."           // 확인 메시지
  }
}
```

### 3. 파라미터 명명
```json
{
  "cart": {
    "totalItems": "총 {count}개의 상품",
    "addSuccess": "{name} {quantity}개가 추가되었습니다"
  }
}
```

---

## 트러블슈팅

### 문제 1: 번역이 표시되지 않음
- ✅ `useLanguage` hook을 'use client' 컴포넌트에서만 사용
- ✅ `LanguageProvider`가 `layout.tsx`에 올바르게 래핑되었는지 확인
- ✅ JSON 파일 경로가 `/locales/{locale}.json`인지 확인

### 문제 2: 파라미터가 치환되지 않음
- ✅ JSON에 `{count}` 형식으로 작성했는지 확인
- ✅ `t('key', { count: value })` 형태로 호출했는지 확인

### 문제 3: 언어 변경이 저장되지 않음
- ✅ localStorage가 활성화되어 있는지 확인
- ✅ 브라우저 시크릿 모드에서는 저장되지 않을 수 있음

---

## 체크리스트

### 새 페이지 다국어 적용 시
- [ ] `'use client'` 추가 (필요 시)
- [ ] `import { useLanguage } from '@/contexts/LanguageContext'` 추가
- [ ] `const { t } = useLanguage()` 선언
- [ ] 하드코딩된 텍스트를 `t('key')` 형태로 변경
- [ ] 3개 언어 JSON 파일에 번역 추가 (ko, en, zh)
- [ ] 빌드 테스트 (`npm run build`)
- [ ] 실제 동작 확인 (언어 전환 테스트)

---

## 참고 자료

### 현재 사용 중인 번역 키 전체 목록

#### common (공통)
- `common.brand` - 브랜드명
- `common.slogan` - 슬로건
- `common.loading` - 로딩 중
- `common.error` - 오류 메시지
- `common.success`, `cancel`, `confirm`, `save`, `delete`, `edit`, `search`, `home`, `back`

#### nav (네비게이션)
- `nav.products`, `nav.content`, `nav.about`
- `nav.cart`, `nav.myPage`
- `nav.login`, `nav.logout`, `nav.signup`

#### cart (장바구니)
- `cart.title`, `cart.empty`, `cart.emptyDesc`, `cart.shopNow`
- `cart.totalItems`, `cart.selectAll`, `cart.selected`
- `cart.productPrice`, `cart.shippingFee`, `cart.free`, `cart.totalAmount`
- `cart.checkout`, `cart.checkoutWithCount`, `cart.selectProducts`
- `cart.removeConfirm`, `cart.addSuccess`, `cart.updateFailed`, `cart.removeFailed`
- `cart.continueShopping`

#### checkout (체크아웃)
- `checkout.title`, `checkout.backToCart`
- `checkout.shippingInfo`, `checkout.recipient`, `checkout.phone`, `checkout.address`
- `checkout.zipCode`, `checkout.addressDetail`, `checkout.deliveryMemo`
- `checkout.paymentMethod`, `checkout.cardPayment`, `checkout.securePayment`
- `checkout.agreements`, `checkout.agreeTerms`, `checkout.agreePrivacy`, `checkout.agreeMarketing`
- `checkout.required`, `checkout.optional`
- `checkout.orderSummary`, `checkout.orderProducts`, `checkout.quantity`, `checkout.items`
- `checkout.payButton`, `checkout.processing`
- `checkout.fillAllFields`, `checkout.agreeRequired`

#### payment (결제)
- `payment.success`, `payment.failed`, `payment.cancelled`
- `payment.orderNumber`, `payment.amount`, `payment.transactionId`
- `payment.errorMessage`, `payment.cancelReason`
- `payment.successMessage`, `payment.failedMessage`, `payment.cancelledMessage`
- `payment.viewOrders`, `payment.retryPayment`, `payment.goHome`

#### products (상품)
- `products.title`, `products.search`, `products.category`
- `products.price`, `products.stock`, `products.soldOut`
- `products.buyNow`, `products.addToCart`, `products.addToWishlist`, `products.share`
- `products.reviews`, `products.questions`, `products.relatedProducts`
- `products.shippingInfo`, `products.domesticShipping`
- `products.freeShipping`, `products.freeShippingCondition`

#### auth (인증)
- `auth.login`, `auth.signup`, `auth.email`, `auth.password`, `auth.name`
- `auth.loginRequired`, `auth.signupSuccess`, `auth.loginSuccess`, `auth.logoutSuccess`

---

## 작업 이력

### 2025-10-01
- ✅ LanguageContext 시스템 구축
- ✅ LanguageSwitcher 컴포넌트 생성
- ✅ 한국어/영어/중국어 번역 파일 작성
- ✅ 장바구니 페이지 다국어 적용
- ✅ 체크아웃 페이지 다국어 적용
- ✅ 결제 결과 페이지 (성공/실패/취소) 다국어 적용
- ✅ 헤더 컴포넌트 다국어 적용
- ✅ 빌드 테스트 완료 (에러 없음)

### 향후 계획
- 🔄 상품 목록/상세 페이지 다국어 적용
- 🔄 로그인/회원가입 페이지 다국어 적용
- 🔄 콘텐츠 페이지 다국어 적용
- 🔄 마이페이지 다국어 적용
- 🔄 관리자/파트너 페이지 다국어 적용 (선택사항)

---

## 연락처 및 지원

프로젝트 관련 문의: Youniqle Development Team

**마지막 업데이트:** 2025년 10월 1일



