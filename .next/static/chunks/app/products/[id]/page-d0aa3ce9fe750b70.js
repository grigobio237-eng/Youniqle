(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3403],{1647:(e,s,a)=>{"use strict";a.d(s,{E:()=>i});var t=a(5155);a(2115);var l=a(3101),r=a(4269);let c=(0,l.F)("inline-flex items-center rounded-full border px-3 py-1 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-white hover:bg-secondary/80",destructive:"border-transparent bg-danger text-white hover:bg-danger/80",outline:"text-text-primary border-gray-300",success:"border-transparent bg-accent text-white hover:bg-accent/80"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:a,...l}=e;return(0,t.jsx)("div",{className:(0,r.cn)(c({variant:a}),s),...l})}},3998:(e,s,a)=>{"use strict";a.d(s,{$:()=>d});var t=a(5155),l=a(2115),r=a(2467),c=a(3101),i=a(4269);let n=(0,c.F)("inline-flex items-center justify-center whitespace-nowrap rounded-2xl text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:scale-105 disabled:hover:scale-100",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-danger text-white hover:bg-danger/90",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white",secondary:"bg-secondary text-white hover:bg-secondary/90",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-3",sm:"h-9 rounded-lg px-3",lg:"h-14 rounded-2xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,s)=>{let{className:a,variant:l,size:c,asChild:d=!1,...x}=e,o=d?r.DX:"button";return(0,t.jsx)(o,{className:(0,i.cn)(n({variant:l,size:c,className:a})),ref:s,...x})});d.displayName="Button"},4269:(e,s,a)=>{"use strict";a.d(s,{$g:()=>c,cn:()=>r});var t=a(2821),l=a(5889);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,l.QP)((0,t.$)(s))}function c(e){return new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(e)}},5142:(e,s,a)=>{"use strict";a.d(s,{p:()=>c});var t=a(5155),l=a(2115),r=a(4269);let c=l.forwardRef((e,s)=>{let{className:a,type:l,...c}=e;return(0,t.jsx)("input",{type:l,className:(0,r.cn)("flex h-12 w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200",a),ref:s,...c})});c.displayName="Input"},5694:(e,s,a)=>{"use strict";a.d(s,{default:()=>c});var t=a(5155),l=a(5239),r=a(2115);function c(e){let{src:s,alt:a,fill:c=!1,width:i,height:n,className:d="",priority:x=!1,fallbackText:o="Y",sizes:m}=e,[h,u]=(0,r.useState)(!1);return h?(0,t.jsx)("div",{className:"".concat(d," bg-primary/10 rounded-lg flex items-center justify-center"),children:(0,t.jsx)("span",{className:"text-primary font-bold text-lg",children:o})}):(0,t.jsx)(l.default,{src:s,alt:a,fill:c,width:i,height:n,className:d,priority:x,sizes:m,onError:()=>u(!0)})}},5885:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Q});var t=a(5155),l=a(6489),r=a(2115),c=a(2619),i=a.n(c),n=a(6948),d=a(3998),x=a(1647),o=a(5694),m=a(9347),h=a(3581),u=a(5937),j=a(5276);function p(e){let{productId:s}=e,[a,l]=(0,r.useState)([]),[c,i]=(0,r.useState)({averageRating:0,ratingStats:{}}),[o,p]=(0,r.useState)(!0),[g,f]=(0,r.useState)("newest"),[N,v]=(0,r.useState)(""),[y,b]=(0,r.useState)(!1),[w,k]=(0,r.useState)(1),[S,C]=(0,r.useState)(!0);(0,r.useEffect)(()=>{A()},[s,g,N,y,w]);let A=async()=>{try{p(!0);let e=new URLSearchParams({productId:s,page:w.toString(),limit:"10",sort:g});N&&e.append("rating",N),y&&e.append("hasImages","true");let a=await fetch("/api/reviews?".concat(e.toString())),t=await a.json();a.ok?(1===w?l(t.reviews):l(e=>[...e,...t.reviews]),i({averageRating:t.averageRating,ratingStats:t.ratingStats}),C(t.pagination.page<t.pagination.pages)):console.error("리뷰 조회 실패:",t.error)}catch(e){console.error("리뷰 조회 중 오류:",e)}finally{p(!1)}},R=async e=>{try{let s=await fetch("/api/reviews/".concat(e,"/helpful"),{method:"POST"});if(s.ok){let a=await s.json();l(s=>s.map(s=>s._id===e?{...s,helpfulCount:a.helpfulCount,helpfulUsers:a.hasVoted?[...s.helpfulUsers,"current-user"]:s.helpfulUsers.filter(e=>"current-user"!==e)}:s))}}catch(e){console.error("도움됨 투표 중 오류:",e)}},P=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"md",a={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"};return(0,t.jsx)("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(l=>(0,t.jsx)(m.A,{className:"".concat(a[s]," ").concat(l<=e?"text-yellow-400 fill-current":"text-gray-300")},l))})},$=Object.values(c.ratingStats).reduce((e,s)=>e+s,0);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 mr-2 text-yellow-400"}),"상품 리뷰"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:c.averageRating.toFixed(1)}),P(Math.round(c.averageRating),"lg"),(0,t.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["총 ",$,"개의 리뷰"]})]}),(0,t.jsx)("div",{className:"space-y-2",children:[5,4,3,2,1].map(e=>{let s=c.ratingStats[e]||0,a=$>0?s/$*100:0;return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600 w-2",children:e}),(0,t.jsx)(m.A,{className:"h-3 w-3 text-yellow-400 fill-current"}),(0,t.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:"".concat(a,"%")}})}),(0,t.jsx)("span",{className:"text-sm text-gray-600 w-8",children:s})]},e)})})]})})]}),(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-4 w-4 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"정렬:"}),(0,t.jsxs)("select",{value:g,onChange:e=>f(e.target.value),className:"border rounded px-2 py-1 text-sm",children:[(0,t.jsx)("option",{value:"newest",children:"최신순"}),(0,t.jsx)("option",{value:"rating",children:"별점순"}),(0,t.jsx)("option",{value:"helpful",children:"도움됨순"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"별점:"}),(0,t.jsxs)("select",{value:N,onChange:e=>v(e.target.value),className:"border rounded px-2 py-1 text-sm",children:[(0,t.jsx)("option",{value:"",children:"전체"}),(0,t.jsx)("option",{value:"5",children:"5점"}),(0,t.jsx)("option",{value:"4",children:"4점"}),(0,t.jsx)("option",{value:"3",children:"3점"}),(0,t.jsx)("option",{value:"2",children:"2점"}),(0,t.jsx)("option",{value:"1",children:"1점"})]})]}),(0,t.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:y,onChange:e=>b(e.target.checked),className:"rounded"}),(0,t.jsx)("span",{className:"text-sm",children:"이미지 있는 리뷰만"})]})]})})}),(0,t.jsxs)("div",{className:"space-y-4",children:[o&&1===w?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})}):0===a.length?(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(u.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"아직 작성된 리뷰가 없습니다."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"첫 번째 리뷰를 작성해보세요!"})]})}):a.map(e=>(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-6",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.userId.avatar?(0,t.jsx)("img",{src:e.userId.avatar,alt:e.userId.name,className:"w-full h-full rounded-full object-cover"}):(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:e.userId.name.charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.userId.name}),e.isVerified&&(0,t.jsx)(x.E,{className:"bg-green-100 text-green-800 text-xs",children:"구매인증"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[P(e.rating,"sm"),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ko-KR")})]})]})]})}),e.title&&(0,t.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,t.jsx)("p",{className:"text-gray-700 mb-4 whitespace-pre-line",children:e.content}),e.images.length>0&&(0,t.jsx)("div",{className:"flex space-x-2 mb-4",children:e.images.map((e,s)=>(0,t.jsx)("img",{src:e,alt:"리뷰 이미지 ".concat(s+1),className:"w-20 h-20 object-cover rounded-lg border"},s))}),e.replies.length>0&&(0,t.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:e.replies.map((e,s)=>(0,t.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-blue-900",children:e.userId.name}),(0,t.jsx)(x.E,{className:"bg-blue-100 text-blue-800 text-xs",children:"admin"===e.userId.role?"관리자":"파트너"}),(0,t.jsx)("span",{className:"text-sm text-blue-600",children:new Date(e.createdAt).toLocaleDateString("ko-KR")})]}),(0,t.jsx)("p",{className:"text-blue-800",children:e.content})]},s))}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:()=>R(e._id),className:"flex items-center space-x-1",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["도움됨 ",e.helpfulCount]})]})})]})},e._id)),S&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(d.$,{variant:"outline",onClick:()=>k(e=>e+1),disabled:o,children:o?"로딩 중...":"더보기"})})]})]})}var g=a(5142),f=a(5664),N=a(5229);function v(e){let{productId:s,productName:a,onReviewSubmitted:c}=e,{data:i}=(0,l.useSession)(),[x,o]=(0,r.useState)(0),[h,u]=(0,r.useState)(0),[j,p]=(0,r.useState)(""),[v,y]=(0,r.useState)(""),[b,w]=(0,r.useState)([]),[k,S]=(0,r.useState)(!1),[C,A]=(0,r.useState)(!1),R=()=>{u(0)},P=async e=>{let s=e.target.files;if(s&&0!==s.length){S(!0);try{let e=Array.from(s).map(async e=>{let s=new FileReader;return new Promise(a=>{s.onload=()=>a(s.result),s.readAsDataURL(e)})}),a=await Promise.all(e);w(e=>[...e,...a])}catch(e){console.error("이미지 업로드 오류:",e),alert("이미지 업로드 중 오류가 발생했습니다.")}finally{S(!1)}}},$=async e=>{if(e.preventDefault(),!(null==i?void 0:i.user))return void alert("로그인이 필요합니다.");if(0===x)return void alert("별점을 선택해주세요.");if(v.trim().length<10)return void alert("리뷰 내용을 10자 이상 입력해주세요.");A(!0);try{let e=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:s,rating:x,title:j.trim()||void 0,content:v.trim(),images:b})});if(e.ok)alert("리뷰가 작성되었습니다. 관리자 승인 후 게시됩니다."),o(0),p(""),y(""),w([]),c();else{let s=await e.json();alert("리뷰 작성 실패: ".concat(s.error))}}catch(e){console.error("리뷰 작성 중 오류:",e),alert("리뷰 작성 중 오류가 발생했습니다.")}finally{A(!1)}};return(null==i?void 0:i.user)?(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 mr-2 text-yellow-400"}),"리뷰 작성"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:a}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"리뷰를 작성할 상품입니다."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["별점 평가 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{o(e)},onMouseEnter:()=>{u(e)},onMouseLeave:R,className:"focus:outline-none",children:(0,t.jsx)(m.A,{className:"h-8 w-8 transition-colors ".concat(e<=(h||x)?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-200")})},e)),(0,t.jsx)("span",{className:"ml-3 text-sm text-gray-600",children:["","별로에요","그저 그래요","보통이에요","좋아요","최고에요"][h||x]||""})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"title",className:"text-sm font-medium text-gray-700",children:"리뷰 제목 (선택사항)"}),(0,t.jsx)(g.p,{id:"title",value:j,onChange:e=>p(e.target.value),placeholder:"리뷰 제목을 입력해주세요",maxLength:100}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[j.length,"/100자"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{htmlFor:"content",className:"text-sm font-medium text-gray-700",children:["리뷰 내용 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("textarea",{id:"content",value:v,onChange:e=>y(e.target.value),placeholder:"상품에 대한 솔직한 리뷰를 작성해주세요. (10자 이상)",className:"w-full min-h-[120px] p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",maxLength:1e3}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[v.length,"/1000자"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"리뷰 이미지 (선택사항)"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:P,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:k}),(0,t.jsx)(d.$,{type:"button",variant:"outline",className:"w-full h-20 border-dashed border-2 border-gray-300 hover:border-gray-400",disabled:k,children:(0,t.jsx)("div",{className:"flex flex-col items-center space-y-2",children:k?(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.A,{className:"h-6 w-6 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"사진을 업로드하세요 (최대 5장)"})]})})})]}),b.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-5 gap-2",children:b.map((e,s)=>(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("img",{src:e,alt:"리뷰 이미지 ".concat(s+1),className:"w-full h-20 object-cover rounded-lg border"}),(0,t.jsx)("button",{type:"button",onClick:()=>{w(e=>e.filter((e,a)=>a!==s))},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(N.A,{className:"h-4 w-4"})})]},s))})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"• 상품과 관련된 사진을 업로드해주세요 • 최대 5장까지 업로드 가능합니다 • 각 이미지는 10MB 이하로 제한됩니다"})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("h5",{className:"font-medium text-blue-900 mb-2",children:"리뷰 작성 가이드"}),(0,t.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,t.jsx)("li",{children:"• 상품의 품질, 배송, 포장에 대한 솔직한 평가를 해주세요"}),(0,t.jsx)("li",{children:"• 개인정보나 연락처는 포함하지 마세요"}),(0,t.jsx)("li",{children:"• 욕설이나 비방성 내용은 금지됩니다"}),(0,t.jsx)("li",{children:"• 관리자 승인 후 게시됩니다"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>{o(0),p(""),y(""),w([])},className:"flex-1",children:"초기화"}),(0,t.jsx)(d.$,{type:"submit",disabled:0===x||v.trim().length<10||C,className:"flex-1",children:C?"작성 중...":"리뷰 작성하기"})]})]})})]}):(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-8 text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"리뷰를 작성하려면 로그인이 필요합니다"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["로그인 후 ",a,"에 대한 리뷰를 작성해보세요."]}),(0,t.jsx)(d.$,{asChild:!0,children:(0,t.jsx)("a",{href:"/auth/signin",children:"로그인하기"})})]})})}var y=a(5239),b=a(4269),w=a(3457),k=a(512);function S(e){let{productId:s,currentProductName:a,currentProductCategory:l}=e,[c,o]=(0,r.useState)([]),[h,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{j()},[s]);let j=async()=>{try{u(!0);let e=await fetch("/api/products/recommend?productId=".concat(s,"&limit=6")),a=await e.json();e.ok?o(a.recommendations||[]):console.error("관련 상품 조회 실패:",a.error)}catch(e){console.error("관련 상품 조회 중 오류:",e)}finally{u(!1)}},p=async(e,s)=>{try{let a=await fetch("/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,quantity:1})});if(a.ok)alert("".concat(s,"이(가) 장바구니에 추가되었습니다!"));else{let e=await a.json();alert("장바구니 추가 실패: ".concat(e.error))}}catch(e){console.error("장바구니 추가 중 오류:",e),alert("장바구니 추가 중 오류가 발생했습니다.")}};return h?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"관련 상품"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:Array.from({length:6}).map((e,s)=>(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)("div",{className:"aspect-square bg-gray-200 animate-pulse rounded-t-lg"}),(0,t.jsxs)(n.Wu,{className:"p-4",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 animate-pulse rounded mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 animate-pulse rounded mb-2"}),(0,t.jsx)("div",{className:"h-6 bg-gray-200 animate-pulse rounded"})]})]},s))})]}):0===c.length?null:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"관련 상품"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[a,"과(와) 함께 보면 좋은 상품들"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:c.map(e=>(0,t.jsxs)(n.Zp,{className:"group hover:shadow-lg transition-shadow duration-300",children:[(0,t.jsx)(i(),{href:"/products/".concat(e._id),children:(0,t.jsxs)("div",{className:"aspect-square relative bg-gray-100 rounded-t-lg overflow-hidden",children:[e.images.length>0?(0,t.jsx)(y.default,{src:e.images[0].url,alt:e.name,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-300",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 16vw"}):(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,t.jsx)(w.A,{className:"h-12 w-12"})}),(0,t.jsx)(x.E,{className:"absolute top-2 left-2 text-xs ".concat((e=>{switch(e){case"같은 카테고리":return"bg-blue-100 text-blue-800";case"비슷한 가격대":return"bg-green-100 text-green-800";case"인기 상품":return"bg-yellow-100 text-yellow-800";default:return"bg-purple-100 text-purple-800"}})(e.recommendationReason)),children:e.recommendationReason}),0===e.stock&&(0,t.jsx)(x.E,{className:"absolute top-2 right-2",variant:"destructive",children:"품절"}),e.featured&&(0,t.jsxs)(x.E,{className:"absolute bottom-2 right-2 bg-yellow-100 text-yellow-800",children:[(0,t.jsx)(m.A,{className:"h-3 w-3 mr-1 fill-current"}),"인기"]})]})}),(0,t.jsxs)(n.Wu,{className:"p-4",children:[(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)(x.E,{variant:"outline",className:"text-xs",children:e.category})}),(0,t.jsx)("h3",{className:"font-semibold text-sm mb-2 line-clamp-2",children:(0,t.jsx)(i(),{href:"/products/".concat(e._id),className:"hover:text-blue-600 transition-colors",children:e.name})}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:e.summary}),(0,t.jsxs)("div",{className:"mb-3",children:[e.originalPrice&&e.originalPrice>e.price&&(0,t.jsx)("span",{className:"text-xs text-gray-500 line-through block",children:(0,b.$g)(e.originalPrice)}),(0,t.jsx)("span",{className:"text-lg font-bold text-blue-600",children:(0,b.$g)(e.price)})]}),(0,t.jsxs)(d.$,{size:"sm",onClick:()=>p(e._id,e.name),disabled:0===e.stock,className:"w-full",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 mr-1"}),0===e.stock?"품절":"담기"]})]})]},e._id))}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,t.jsxs)(i(),{href:"/products?category=".concat(l),children:[l," 카테고리 더 보기"]})})})]})}var C=a(1503),A=a(1873),R=a(7217),P=a(3327),$=a(3873),E=a(5707),Z=a(6617);function I(e){let{product:s}=e;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"상품 상세 정보"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[s.name,"에 대한 자세한 정보를 확인하세요"]})]}),(()=>{switch(s.category.toLowerCase()){case"fresh-food":case"신선식품":return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(C.A,{className:"h-5 w-5 mr-2 text-green-600"}),"영양성분 정보"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"칼로리"}),(0,t.jsx)("span",{className:"font-medium",children:"약 250kcal/100g"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"단백질"}),(0,t.jsx)("span",{className:"font-medium",children:"25g"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"지방"}),(0,t.jsx)("span",{className:"font-medium",children:"15g"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"탄수화물"}),(0,t.jsx)("span",{className:"font-medium",children:"0g"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"나트륨"}),(0,t.jsx)("span",{className:"font-medium",children:"60mg"})]})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(A.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"원산지 및 보관법"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"원산지:"}),(0,t.jsx)("span",{className:"ml-2",children:"한국 (전라북도)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"보관법:"}),(0,t.jsx)("span",{className:"ml-2",children:"냉장 보관 (0-4\xb0C)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"유통기한:"}),(0,t.jsx)("span",{className:"ml-2",children:"포장일로부터 7일"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"포장방법:"}),(0,t.jsx)("span",{className:"ml-2",children:"진공포장"})]})]})})]})]});case"apparel":case"의류":case"clothing":return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(R.A,{className:"h-5 w-5 mr-2 text-purple-600"}),"사이즈 가이드"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-gray-700 mb-2",children:"표준 사이즈 (cm)"}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium",children:"S"}),(0,t.jsx)("div",{children:"85-90"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium",children:"M"}),(0,t.jsx)("div",{children:"90-95"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium",children:"L"}),(0,t.jsx)("div",{children:"95-100"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-medium",children:"XL"}),(0,t.jsx)("div",{children:"100-105"})]})]})]}),(0,t.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-yellow-800",children:[(0,t.jsx)(P.A,{className:"h-3 w-3 inline mr-1"}),"사이즈는 측정 방법에 따라 차이가 있을 수 있습니다."]})})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)($.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"소재 및 관리"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"소재:"}),(0,t.jsx)("span",{className:"ml-2",children:"100% 면"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"세탁법:"}),(0,t.jsx)("span",{className:"ml-2",children:"세탁기 사용 가능 (30\xb0C 이하)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"표백:"}),(0,t.jsx)("span",{className:"ml-2",children:"금지"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"다림질:"}),(0,t.jsx)("span",{className:"ml-2",children:"중온 (150\xb0C 이하)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"드라이클리닝:"}),(0,t.jsx)("span",{className:"ml-2",children:"가능"})]})]})})]})]});case"electronics":case"전자제품":case"전자기기":return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(E.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"기술 사양"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"프로세서"}),(0,t.jsx)("span",{className:"font-medium",children:"Apple A16 Bionic"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"메모리"}),(0,t.jsx)("span",{className:"font-medium",children:"8GB RAM"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"저장공간"}),(0,t.jsx)("span",{className:"font-medium",children:"256GB"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"디스플레이"}),(0,t.jsx)("span",{className:"font-medium",children:"6.1인치 Super Retina XDR"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"카메라"}),(0,t.jsx)("span",{className:"font-medium",children:"48MP 메인 + 12MP 울트라와이드"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"배터리"}),(0,t.jsx)("span",{className:"font-medium",children:"최대 29시간 비디오 재생"})]})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(Z.A,{className:"h-5 w-5 mr-2 text-green-600"}),"포함 사항 및 보증"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"포함 사항:"}),(0,t.jsxs)("ul",{className:"mt-1 ml-4 list-disc space-y-1",children:[(0,t.jsx)("li",{children:"기기 본체"}),(0,t.jsx)("li",{children:"USB-C to Lightning 케이블"}),(0,t.jsx)("li",{children:"20W USB-C 전원 어댑터"}),(0,t.jsx)("li",{children:"사용 설명서"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"제조사 보증:"}),(0,t.jsx)("span",{className:"ml-2",children:"1년"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"A/S 센터:"}),(0,t.jsx)("span",{className:"ml-2",children:"전국 애플 공식 서비스센터"})]})]})})]})]});default:return(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center text-lg",children:[(0,t.jsx)(P.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"상품 정보"]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"카테고리:"}),(0,t.jsx)(x.E,{variant:"outline",className:"ml-2",children:s.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"재고:"}),(0,t.jsxs)("span",{className:"ml-2",children:[s.stock,"개"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"상품 설명:"}),(0,t.jsx)("p",{className:"mt-1 text-gray-600",children:s.description})]})]})})]})}})()]})}var _=a(7910),W=a(8854),L=a(508),B=a(6191),F=a(9708),O=a(799);function T(e){let{productId:s,productName:a}=e,{data:c}=(0,l.useSession)(),[i,o]=(0,r.useState)([]),[m,h]=(0,r.useState)(!0),[j,p]=(0,r.useState)(!1),[f,N]=(0,r.useState)(!1),[v,y]=(0,r.useState)(1),[b,w]=(0,r.useState)(!0),[k,S]=(0,r.useState)({title:"",content:"",isPrivate:!1});(0,r.useEffect)(()=>{C()},[s,v]);let C=async()=>{try{h(!0);let e=await fetch("/api/questions?productId=".concat(s,"&page=").concat(v,"&limit=10")),a=await e.json();e.ok?(1===v?o(a.questions||[]):o(e=>[...e,...a.questions]),w(a.pagination.page<a.pagination.pages)):console.error("문의 조회 실패:",a.error)}catch(e){console.error("문의 조회 중 오류:",e)}finally{h(!1)}},A=async e=>{if(e.preventDefault(),!(null==c?void 0:c.user))return void alert("로그인이 필요합니다.");if(!k.title.trim()||!k.content.trim())return void alert("제목과 내용을 입력해주세요.");N(!0);try{let e=await fetch("/api/questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:s,title:k.title.trim(),content:k.content.trim(),isPrivate:k.isPrivate})});if(e.ok)alert("문의가 등록되었습니다."),S({title:"",content:"",isPrivate:!1}),p(!1),y(1),C();else{let s=await e.json();alert("문의 등록 실패: ".concat(s.error))}}catch(e){console.error("문의 등록 중 오류:",e),alert("문의 등록 중 오류가 발생했습니다.")}finally{N(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,t.jsx)(u.A,{className:"h-6 w-6 mr-2"}),"상품 문의"]}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:[a,"에 대한 문의사항을 남겨주세요"]})]}),(null==c?void 0:c.user)&&(0,t.jsxs)(d.$,{onClick:()=>p(!j),className:"flex items-center",children:[(0,t.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"문의하기"]})]}),j&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"상품 문의 작성"})}),(0,t.jsx)(n.Wu,{children:(null==c?void 0:c.user)?(0,t.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(g.p,{placeholder:"문의 제목을 입력해주세요",value:k.title,onChange:e=>S(s=>({...s,title:e.target.value})),maxLength:100,required:!0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[k.title.length,"/100자"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("textarea",{placeholder:"문의 내용을 입력해주세요",value:k.content,onChange:e=>S(s=>({...s,content:e.target.value})),className:"w-full min-h-[120px] p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",maxLength:1e3,required:!0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[k.content.length,"/1000자"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"isPrivate",checked:k.isPrivate,onChange:e=>S(s=>({...s,isPrivate:e.target.checked})),className:"rounded"}),(0,t.jsxs)("label",{htmlFor:"isPrivate",className:"text-sm text-gray-700 flex items-center",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 mr-1"}),"비공개 문의 (관리자와 파트너만 볼 수 있습니다)"]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>{S({title:"",content:"",isPrivate:!1}),p(!1)},className:"flex-1",children:"취소"}),(0,t.jsx)(d.$,{type:"submit",disabled:f||!k.title.trim()||!k.content.trim(),className:"flex-1",children:f?"등록 중...":"문의 등록"})]})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"로그인이 필요합니다"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"상품 문의를 작성하려면 로그인해주세요."}),(0,t.jsx)(d.$,{asChild:!0,children:(0,t.jsx)("a",{href:"/auth/signin",children:"로그인하기"})})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[m&&1===v?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})}):0===i.length?(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(u.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"아직 등록된 문의가 없습니다."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"첫 번째 문의를 작성해보세요!"})]})}):i.map(e=>(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-6",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.userId.avatar?(0,t.jsx)("img",{src:e.userId.avatar,alt:e.userId.name,className:"w-full h-full rounded-full object-cover"}):(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:e.userId.name.charAt(0)})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.userId.name}),e.isPrivate?(0,t.jsxs)(x.E,{className:"bg-red-100 text-red-800 text-xs",children:[(0,t.jsx)(F.A,{className:"h-3 w-3 mr-1"}),"비공개"]}):(0,t.jsxs)(x.E,{className:"bg-green-100 text-green-800 text-xs",children:[(0,t.jsx)(O.A,{className:"h-3 w-3 mr-1"}),"공개"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ko-KR")}),(e=>{switch(e){case"pending":return(0,t.jsx)(x.E,{className:"bg-yellow-100 text-yellow-800",children:"답변 대기"});case"answered":return(0,t.jsx)(x.E,{className:"bg-green-100 text-green-800",children:"답변 완료"});case"closed":return(0,t.jsx)(x.E,{className:"bg-gray-100 text-gray-800",children:"종료"});default:return null}})(e.status)]})]})]})}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,t.jsx)("p",{className:"text-gray-700 whitespace-pre-line",children:e.content})]}),e.answers.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900",children:"답변"}),e.answers.map((e,s)=>(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(e=>{switch(e){case"admin":return(0,t.jsx)(_.A,{className:"h-4 w-4 text-red-500"});case"partner":return(0,t.jsx)(W.A,{className:"h-4 w-4 text-blue-500"});default:return(0,t.jsx)(L.A,{className:"h-4 w-4 text-gray-500"})}})(e.userId.role),(0,t.jsx)("span",{className:"font-medium text-blue-900",children:e.userId.name}),(0,t.jsx)(x.E,{className:"text-xs ".concat(e.isOfficial?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.isOfficial?"공식 답변":"일반 답변"}),(0,t.jsx)("span",{className:"text-sm text-blue-600",children:new Date(e.createdAt).toLocaleDateString("ko-KR")})]}),(0,t.jsx)("p",{className:"text-blue-800 whitespace-pre-line",children:e.content})]},s))]})]})},e._id)),b&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(d.$,{variant:"outline",onClick:()=>y(e=>e+1),disabled:m,children:m?"로딩 중...":"더보기"})})]})]})}var D=a(5917),z=a(7181),q=a(5426),U=a(3155),M=a(7378),J=a(3664);function K(e){let{productName:s,productUrl:a,productImage:l,productPrice:c}=e,[i,n]=(0,r.useState)(!1),[x,o]=(0,r.useState)(!1),m='"'.concat(s,'"').concat(c?" - ".concat(c.toLocaleString(),"원"):"","를 확인해보세요!"),h=encodeURIComponent(a),j=encodeURIComponent(m),p={facebook:"https://www.facebook.com/sharer/sharer.php?u=".concat(h),twitter:"https://twitter.com/intent/tweet?text=".concat(j,"&url=").concat(h),kakao:"https://story.kakao.com/share?url=".concat(h,"&text=").concat(j),email:"mailto:?subject=".concat(encodeURIComponent(s),"&body=").concat(j,"%0A%0A").concat(h)},g=e=>{let s=p[e];s&&window.open(s,"_blank","width=600,height=400"),n(!1)},f=async()=>{try{await navigator.clipboard.writeText(a),o(!0),setTimeout(()=>o(!1),2e3),n(!1)}catch(s){console.error("링크 복사 실패:",s);let e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),o(!0),setTimeout(()=>o(!1),2e3),n(!1)}},N=async()=>{if(navigator.share)try{await navigator.share({title:s,text:m,url:a}),n(!1)}catch(e){console.error("네이티브 공유 실패:",e)}};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(d.$,{variant:"outline",onClick:()=>n(!i),className:"flex items-center space-x-2",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"복사됨"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"공유하기"})]})}),i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border z-20",children:(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"공유하기"}),(0,t.jsxs)("div",{className:"space-y-2",children:["undefined"!=typeof navigator&&"share"in navigator&&(0,t.jsxs)(d.$,{variant:"ghost",onClick:N,className:"w-full justify-start",children:[(0,t.jsx)(z.A,{className:"h-4 w-4 mr-3"}),"공유하기"]}),(0,t.jsx)(d.$,{variant:"ghost",onClick:f,className:"w-full justify-start",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.A,{className:"h-4 w-4 mr-3 text-green-600"}),(0,t.jsx)("span",{className:"text-green-600",children:"링크 복사됨"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-3"}),"링크 복사"]})}),(0,t.jsxs)(d.$,{variant:"ghost",onClick:()=>g("facebook"),className:"w-full justify-start",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 mr-3 text-blue-600"}),"Facebook"]}),(0,t.jsxs)(d.$,{variant:"ghost",onClick:()=>g("twitter"),className:"w-full justify-start",children:[(0,t.jsx)(M.A,{className:"h-4 w-4 mr-3 text-blue-400"}),"Twitter"]}),(0,t.jsxs)(d.$,{variant:"ghost",onClick:()=>g("kakao"),className:"w-full justify-start",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-3 text-yellow-500"}),"카카오톡"]}),(0,t.jsxs)(d.$,{variant:"ghost",onClick:()=>g("email"),className:"w-full justify-start",children:[(0,t.jsx)(J.A,{className:"h-4 w-4 mr-3 text-gray-600"}),"이메일"]})]}),(0,t.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 line-clamp-2",children:s}),c&&(0,t.jsxs)("div",{className:"text-blue-600 font-medium",children:[c.toLocaleString(),"원"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:a})]})})]})})]})]})}var V=a(368),X=a(7937),G=a(7125),H=a(6398);function Q(e){let{params:s}=e,{data:a}=(0,l.useSession)(),[c,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(!0),[j,g]=(0,r.useState)(1),[f,N]=(0,r.useState)(0),[y,b]=(0,r.useState)(!1),[C,A]=(0,r.useState)(!1),[R,P]=(0,r.useState)(!1);(0,r.useEffect)(()=>{$()},[]),(0,r.useEffect)(()=>{(null==a?void 0:a.user)&&c&&E()},[a,c]),(0,r.useEffect)(()=>{c&&function(e){let s=localStorage.getItem("recentlyViewed"),a=s?JSON.parse(s):[];(a=a.filter(s=>s._id!==e._id)).unshift(e),a=a.slice(0,20),localStorage.setItem("recentlyViewed",JSON.stringify(a))}({_id:c._id,name:c.name,price:c.price,originalPrice:c.originalPrice,images:c.images.map(e=>({url:e})),category:c.category,summary:c.summary,stock:c.stock,featured:c.featured})},[c]);let $=async()=>{try{let{id:e}=await s,a=await fetch("/api/products/".concat(e));if(a.ok){let e=await a.json();m(e.product)}else console.error("상품 조회 실패")}catch(e){console.error("상품 조회 중 오류:",e)}finally{u(!1)}},E=async()=>{if((null==a?void 0:a.user)&&c)try{let s=await fetch("/api/wishlist");if(s.ok){var e;let a=null==(e=(await s.json()).wishlist)?void 0:e.some(e=>e.productId._id===c._id);b(a)}}catch(e){console.error("위시리스트 상태 확인 오류:",e)}},Z=async()=>{if(!(null==a?void 0:a.user))return void alert("로그인이 필요합니다.");A(!0);try{let e=await fetch("/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:null==c?void 0:c._id,quantity:j})});if(e.ok)alert("".concat(null==c?void 0:c.name," ").concat(j,"개가 장바구니에 추가되었습니다!"));else{let s=await e.json();alert("장바구니 추가 실패: ".concat(s.error))}}catch(e){console.error("장바구니 추가 중 오류:",e),alert("장바구니 추가 중 오류가 발생했습니다.")}finally{A(!1)}},W=async()=>{if(!(null==a?void 0:a.user))return void alert("로그인이 필요합니다.");P(!0);try{let e=await fetch("/api/wishlist",{method:y?"DELETE":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:null==c?void 0:c._id})});if(e.ok)b(!y),alert(y?"위시리스트에서 제거되었습니다.":"위시리스트에 추가되었습니다!");else{let s=await e.json();alert("위시리스트 처리 실패: ".concat(s.error))}}catch(e){console.error("위시리스트 처리 중 오류:",e),alert("위시리스트 처리 중 오류가 발생했습니다.")}finally{P(!1)}},L=e=>{let s=j+e;s>=1&&s<=((null==c?void 0:c.stock)||0)&&g(s)},F=e=>{if(!(null==c?void 0:c.images))return;let s=c.images.length;"prev"===e?N(e=>0===e?s-1:e-1):N(e=>e===s-1?0:e+1)},O=e=>e.toLocaleString("ko-KR");if(h)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});if(!c)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(n.Zp,{className:"w-full max-w-md",children:(0,t.jsxs)(n.Wu,{className:"p-8 text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"상품을 찾을 수 없습니다"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"요청하신 상품이 존재하지 않거나 삭제되었습니다."}),(0,t.jsx)(d.$,{asChild:!0,children:(0,t.jsx)(i(),{href:"/products",children:"상품 목록으로 돌아가기"})})]})})});let D=(null==c?void 0:c.originalPrice)&&(null==c?void 0:c.price)?Math.round((c.originalPrice-c.price)/c.originalPrice*100):0;return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-emerald-50 py-8",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 max-w-7xl",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-6",children:[(0,t.jsx)(i(),{href:"/",className:"hover:text-blue-600",children:"홈"}),(0,t.jsx)("span",{children:"/"}),(0,t.jsx)(i(),{href:"/products",className:"hover:text-blue-600",children:"상품"}),(0,t.jsx)("span",{children:"/"}),(0,t.jsx)(i(),{href:"/products?category=".concat(c.category),className:"hover:text-blue-600",children:c.category}),(0,t.jsx)("span",{children:"/"}),(0,t.jsx)("span",{className:"text-gray-900",children:c.name})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"relative aspect-square bg-white rounded-lg shadow-lg overflow-hidden",children:c.images&&c.images.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:c.images[f],alt:c.name,className:"w-full h-full object-cover"}),c.images.length>1&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.$,{variant:"ghost",size:"sm",className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white",onClick:()=>F("prev"),children:(0,t.jsx)(V.A,{className:"h-4 w-4"})}),(0,t.jsx)(d.$,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white",onClick:()=>F("next"),children:(0,t.jsx)(X.A,{className:"h-4 w-4"})})]})]}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,t.jsx)(o.default,{src:"/character/youniqle-4.png",alt:"상품 이미지 없음",width:200,height:200,className:"object-contain opacity-50"})})}),c.images&&c.images.length>1&&(0,t.jsx)("div",{className:"flex space-x-2 overflow-x-auto",children:c.images.map((e,s)=>(0,t.jsx)("button",{onClick:()=>N(s),className:"flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 ".concat(f===s?"border-blue-500":"border-gray-200 hover:border-gray-300"),children:(0,t.jsx)("img",{src:e,alt:"".concat(c.name," ").concat(s+1),className:"w-full h-full object-cover"})},s))})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(x.E,{variant:"secondary",children:c.category}),c.featured&&(0,t.jsx)(x.E,{className:"bg-yellow-100 text-yellow-800",children:"인기"}),D>0&&(0,t.jsxs)(x.E,{className:"bg-red-100 text-red-800",children:[D,"% 할인"]})]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:c.name}),(0,t.jsx)("p",{className:"text-gray-600 text-lg mb-4",children:c.summary}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[c.originalPrice&&c.originalPrice>c.price&&(0,t.jsxs)("span",{className:"text-lg text-gray-500 line-through",children:[O(c.originalPrice),"원"]}),(0,t.jsxs)("span",{className:"text-3xl font-bold text-blue-600",children:[O(c.price),"원"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"재고:"}),(0,t.jsx)("span",{className:"font-medium ".concat(c.stock>10?"text-green-600":c.stock>0?"text-yellow-600":"text-red-600"),children:c.stock>0?"".concat(c.stock,"개 남음"):"품절"})]}),c.stock>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"수량:"}),(0,t.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[(0,t.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>L(-1),disabled:j<=1,className:"h-8 w-8 p-0",children:(0,t.jsx)(G.A,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"px-4 py-1 text-center min-w-[3rem]",children:j}),(0,t.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>L(1),disabled:j>=c.stock,className:"h-8 w-8 p-0",children:(0,t.jsx)(B.A,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-lg font-medium text-gray-700",children:"총 상품금액"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[O(c.price*j),"원"]})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(d.$,{onClick:()=>window.location.href="/checkout?product=".concat(c._id,"&quantity=").concat(j),disabled:0===c.stock,className:"w-full bg-blue-600 hover:bg-blue-700 text-lg py-3",children:0===c.stock?"품절":"바로 구매하기"}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsxs)(d.$,{variant:y?"default":"outline",onClick:W,disabled:R,className:"flex-1",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2 ".concat(y?"fill-current":"")}),y?"위시리스트 제거":"위시리스트"]}),(0,t.jsxs)(d.$,{onClick:Z,disabled:0===c.stock||C,className:"flex-1",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 mr-2"}),0===c.stock?"품절":"장바구니 담기"]})]})]}),(0,t.jsx)("div",{className:"flex space-x-2",children:(0,t.jsx)(K,{productName:c.name,productUrl:"".concat(window.location.origin,"/products/").concat(c._id),productPrice:c.price})}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg space-y-2",children:[(0,t.jsxs)("h3",{className:"font-semibold text-blue-900 flex items-center",children:[(0,t.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"배송 정보"]}),(0,t.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,t.jsx)("p",{children:"• 무료배송 (3만원 이상 구매시, 국내배송 한정)"}),(0,t.jsx)("p",{children:"• 평일 오후 2시 이전 주문시 당일 발송"}),(0,t.jsx)("p",{children:"• 배송 기간: 1-2일 (주말/공휴일 제외)"}),(0,t.jsx)("p",{children:"• 섬지역 추가 배송비: 5,000원"})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg space-y-2",children:[(0,t.jsxs)("h3",{className:"font-semibold text-green-900 flex items-center",children:[(0,t.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"안전 결제"]}),(0,t.jsxs)("div",{className:"text-sm text-green-800 space-y-1",children:[(0,t.jsx)("p",{children:"• Nicepay 보안 결제 시스템"}),(0,t.jsx)("p",{children:"• SSL 암호화 통신"}),(0,t.jsx)("p",{children:"• 7일 무조건 환불 보장"})]})]})]})]}),(0,t.jsx)("div",{className:"mt-12",children:(0,t.jsx)(I,{product:c})}),(0,t.jsx)(n.Zp,{className:"shadow-lg",children:(0,t.jsxs)(n.Wu,{className:"p-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"상품 설명"}),(0,t.jsx)("div",{className:"prose prose-gray max-w-none",children:(0,t.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:c.description})})]})}),(0,t.jsx)("div",{className:"mt-12",children:(0,t.jsx)(p,{productId:c._id})}),(0,t.jsx)("div",{className:"mt-12",children:(0,t.jsx)(v,{productId:c._id,productName:c.name,onReviewSubmitted:()=>{window.location.reload()}})}),(0,t.jsx)("div",{className:"mt-12",children:(0,t.jsx)(T,{productId:c._id,productName:c.name})}),(0,t.jsx)("div",{className:"mt-12",children:(0,t.jsx)(S,{productId:c._id,currentProductName:c.name,currentProductCategory:c.category})})]})})}},6948:(e,s,a)=>{"use strict";a.d(s,{Wu:()=>d,ZB:()=>n,Zp:()=>c,aR:()=>i});var t=a(5155),l=a(2115),r=a(4269);let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("rounded-2xl border bg-white text-gray-950 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",a),...l})});c.displayName="Card";let i=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...l})});i.displayName="CardHeader";let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...l})});n.displayName="CardTitle",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-gray-600",a),...l})}).displayName="CardDescription";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",a),...l})});d.displayName="CardContent",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter"},7319:(e,s,a)=>{Promise.resolve().then(a.bind(a,5885))}},e=>{e.O(0,[5239,2619,1691,6489,9285,8441,1255,7358],()=>e(e.s=7319)),_N_E=e.O()}]);